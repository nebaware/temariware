<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TemariWare - Complete Student Ecosystem</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#14F195',
            secondary: '#9945FF',
            accent: '#F59E0B',
            success: '#10B981',
            dark: '#0F172A'
          }
        }
      }
    }
  </script>
  <style>
    .glass { background: rgba(15, 23, 42, 0.8); backdrop-filter: blur(16px); border: 1px solid rgba(255, 255, 255, 0.1); }
    .gradient-bg { background: linear-gradient(135deg, #0F172A 0%, #1E293B 50%, #334155 100%); }
    .page { display: none; }
    .page.active { display: block; }
    .modal { display: none; }
    .modal.active { display: flex; }
  </style>
</head>
<body class="gradient-bg text-white min-h-screen">
  <div class="container mx-auto px-4 py-6 max-w-md">
    
    <!-- Navigation Bar -->
    <nav class="glass rounded-xl p-4 mb-6 fixed bottom-4 left-4 right-4 z-50 max-w-md mx-auto">
      <div class="flex justify-around">
        <button onclick="showPage('home')" class="nav-btn flex flex-col items-center p-2 rounded-lg transition-colors" data-page="home">
          <span class="text-xl mb-1">üè†</span>
          <span class="text-xs">Home</span>
        </button>
        <button onclick="showPage('work')" class="nav-btn flex flex-col items-center p-2 rounded-lg transition-colors" data-page="work">
          <span class="text-xl mb-1">üíº</span>
          <span class="text-xs">Work</span>
        </button>
        <button onclick="showPage('gebeta')" class="nav-btn flex flex-col items-center p-2 rounded-lg transition-colors" data-page="gebeta">
          <span class="text-xl mb-1">üìö</span>
          <span class="text-xs">Gebeta</span>
        </button>
        <button onclick="showPage('wallet')" class="nav-btn flex flex-col items-center p-2 rounded-lg transition-colors" data-page="wallet">
          <span class="text-xl mb-1">üí∞</span>
          <span class="text-xs">Wallet</span>
        </button>
        <button onclick="showPage('profile')" class="nav-btn flex flex-col items-center p-2 rounded-lg transition-colors" data-page="profile">
          <span class="text-xl mb-1">üë§</span>
          <span class="text-xs">Me</span>
        </button>
      </div>
    </nav>

    <!-- Home Page -->
    <div id="home-page" class="page active">
      <div class="text-center mb-6">
        <h1 class="text-3xl font-bold bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent mb-2">TemariWare</h1>
        <p class="text-gray-400">Complete Student Ecosystem</p>
      </div>

      <!-- User Card -->
      <div class="glass rounded-2xl p-6 mb-6">
        <div class="flex items-center gap-4 mb-4">
          <div class="w-16 h-16 bg-gradient-to-r from-primary to-secondary rounded-full flex items-center justify-center text-xl font-bold text-black" id="user-avatar">
            üë§
          </div>
          <div>
            <h2 class="text-xl font-bold" id="user-name">Welcome!</h2>
            <p class="text-gray-400" id="user-headline">Ready to explore?</p>
          </div>
        </div>
        
        <div class="bg-gradient-to-r from-success/20 to-primary/20 rounded-xl p-4 border border-success/30">
          <div class="flex justify-between items-center">
            <div>
              <p class="text-sm text-gray-300">Wallet Balance</p>
              <p class="text-2xl font-bold text-success" id="balance-display">0 ETB</p>
            </div>
            <div class="text-3xl">üí∞</div>
          </div>
        </div>
      </div>

      <!-- Auth Section -->
      <div id="auth-section" class="mb-6">
        <div class="grid grid-cols-2 gap-3">
          <button onclick="showModal('login')" class="bg-gradient-to-r from-primary to-blue-500 p-4 rounded-xl font-semibold">
            üîê Sign In
          </button>
          <button onclick="showModal('register')" class="bg-gradient-to-r from-secondary to-purple-500 p-4 rounded-xl font-semibold">
            ‚ú® Register
          </button>
        </div>
      </div>

      <!-- Quick Actions -->
      <div class="grid grid-cols-2 gap-4 mb-6">
        <button onclick="showPage('work')" class="glass rounded-xl p-6 text-center hover:bg-white/10 transition-all">
          <div class="text-4xl mb-3">üíº</div>
          <h3 class="font-bold text-lg mb-1">Find Work</h3>
          <p class="text-xs text-gray-400">Jobs & Internships</p>
        </button>
        
        <button onclick="showPage('gebeta')" class="glass rounded-xl p-6 text-center hover:bg-white/10 transition-all">
          <div class="text-4xl mb-3">üìö</div>
          <h3 class="font-bold text-lg mb-1">Learn</h3>
          <p class="text-xs text-gray-400">Courses & Skills</p>
        </button>
        
        <button onclick="showPage('wallet')" class="glass rounded-xl p-6 text-center hover:bg-white/10 transition-all">
          <div class="text-4xl mb-3">üí≥</div>
          <h3 class="font-bold text-lg mb-1">Ekub</h3>
          <p class="text-xs text-gray-400">Savings Groups</p>
        </button>
        
        <button onclick="showNetworkModal()" class="glass rounded-xl p-6 text-center hover:bg-white/10 transition-all">
          <div class="text-4xl mb-3">üë•</div>
          <h3 class="font-bold text-lg mb-1">Network</h3>
          <p class="text-xs text-gray-400">Connect & Chat</p>
        </button>
      </div>

      <!-- Stats -->
      <div class="glass rounded-xl p-4 mb-6">
        <h3 class="font-bold mb-4 text-center">üìä Your Progress</h3>
        <div class="grid grid-cols-3 gap-4">
          <div class="text-center">
            <div class="text-2xl font-bold text-accent" id="user-xp">0</div>
            <div class="text-xs text-gray-400">XP Points</div>
          </div>
          <div class="text-center">
            <div class="text-2xl font-bold text-primary" id="user-level">1</div>
            <div class="text-xs text-gray-400">Level</div>
          </div>
          <div class="text-center">
            <div class="text-2xl font-bold text-success" id="user-streak">0</div>
            <div class="text-xs text-gray-400">Day Streak</div>
          </div>
        </div>
      </div>

      <!-- Daily Reward -->
      <div class="glass rounded-xl p-6 text-center mb-20">
        <div class="text-5xl mb-3">üéÅ</div>
        <h3 class="text-xl font-bold mb-2">Daily Bonus</h3>
        <p class="text-gray-400 mb-4">Claim your reward now!</p>
        <button onclick="claimDailyReward()" class="bg-gradient-to-r from-accent to-orange-500 px-8 py-3 rounded-xl font-bold">
          Claim 150 ETB
        </button>
      </div>
    </div>

    <!-- Work Page -->
    <div id="work-page" class="page">
      <div class="flex items-center justify-between mb-6">
        <h1 class="text-2xl font-bold">üíº Find Work</h1>
        <button onclick="refreshJobs()" class="bg-primary/20 p-2 rounded-lg">üîÑ</button>
      </div>

      <!-- Job Filters -->
      <div class="mb-4">
        <div class="flex gap-2 mb-3 overflow-x-auto">
          <button onclick="filterJobs('all')" class="filter-btn bg-primary/20 px-4 py-2 rounded-lg text-sm whitespace-nowrap">All</button>
          <button onclick="filterJobs('Internship')" class="filter-btn bg-white/10 px-4 py-2 rounded-lg text-sm whitespace-nowrap">Internships</button>
          <button onclick="filterJobs('Freelance')" class="filter-btn bg-white/10 px-4 py-2 rounded-lg text-sm whitespace-nowrap">Freelance</button>
          <button onclick="filterJobs('Remote')" class="filter-btn bg-white/10 px-4 py-2 rounded-lg text-sm whitespace-nowrap">Remote</button>
        </div>
        <input type="text" placeholder="Search jobs..." class="w-full p-3 bg-white/10 rounded-xl border border-white/20 focus:border-primary focus:outline-none" onkeyup="searchJobs(this.value)">
      </div>

      <!-- Jobs List -->
      <div class="space-y-4 mb-20" id="jobs-list">
        <!-- Jobs will be populated here -->
      </div>
    </div>

    <!-- Gebeta (Learning) Page -->
    <div id="gebeta-page" class="page">
      <div class="flex items-center justify-between mb-6">
        <h1 class="text-2xl font-bold">üìö Gebeta Learning</h1>
        <button onclick="showModal('create-course')" class="bg-primary/20 p-2 rounded-lg">‚ûï</button>
      </div>

      <!-- Course Categories -->
      <div class="flex gap-2 mb-4 overflow-x-auto">
        <button onclick="filterCourses('all')" class="course-filter-btn bg-primary/20 px-4 py-2 rounded-lg text-sm whitespace-nowrap">All</button>
        <button onclick="filterCourses('Design')" class="course-filter-btn bg-white/10 px-4 py-2 rounded-lg text-sm whitespace-nowrap">Design</button>
        <button onclick="filterCourses('Development')" class="course-filter-btn bg-white/10 px-4 py-2 rounded-lg text-sm whitespace-nowrap">Development</button>
        <button onclick="filterCourses('Business')" class="course-filter-btn bg-white/10 px-4 py-2 rounded-lg text-sm whitespace-nowrap">Business</button>
      </div>

      <!-- Courses List -->
      <div class="space-y-4 mb-20" id="courses-list">
        <!-- Courses will be populated here -->
      </div>
    </div>

    <!-- Wallet Page -->
    <div id="wallet-page" class="page">
      <div class="flex items-center justify-between mb-6">
        <h1 class="text-2xl font-bold">üí∞ My Wallet</h1>
        <button onclick="refreshWallet()" class="bg-primary/20 p-2 rounded-lg">üîÑ</button>
      </div>

      <!-- Wallet Actions -->
      <div class="glass rounded-xl p-6 mb-6">
        <div class="text-center mb-4">
          <p class="text-gray-400 mb-2">Total Balance</p>
          <p class="text-4xl font-bold text-success" id="wallet-balance">0 ETB</p>
        </div>
        <div class="grid grid-cols-2 gap-4">
          <button onclick="showSendMoneyFlow()" class="bg-success text-white p-3 rounded-lg font-semibold">üí∏ Send</button>
          <button onclick="showAddFundsFlow()" class="bg-primary text-black p-3 rounded-lg font-semibold">üí≥ Add Funds</button>
        </div>
      </div>

      <!-- My Applications -->
      <div class="glass rounded-xl p-4 mb-6">
        <div class="flex justify-between items-center mb-4">
          <h3 class="font-bold">üíº My Applications</h3>
          <button onclick="showPage('work')" class="text-primary text-sm">View All</button>
        </div>
        <div id="my-applications">
          <!-- Applications will be populated here -->
        </div>
      </div>

      <!-- My Courses -->
      <div class="glass rounded-xl p-4 mb-6">
        <div class="flex justify-between items-center mb-4">
          <h3 class="font-bold">üìö My Courses</h3>
          <button onclick="showPage('gebeta')" class="text-primary text-sm">Browse More</button>
        </div>
        <div id="my-courses">
          <!-- Enrolled courses will be populated here -->
        </div>
      </div>

      <!-- Ekub Section -->
      <div class="glass rounded-xl p-4 mb-6">
        <div class="flex justify-between items-center mb-4">
          <h3 class="font-bold">ü§ù Available Ekubs</h3>
          <button onclick="showCreateEkubModal()" class="bg-primary/20 px-3 py-1 rounded text-sm">+ Create</button>
        </div>
        <div id="ekubs-list">
          <div class="bg-white/5 rounded-lg p-3 mb-3">
            <div class="flex justify-between items-start mb-2">
              <div>
                <h4 class="font-semibold">Laptop Fund Ekub</h4>
                <p class="text-xs text-gray-400">12 members ‚Ä¢ 2,000 ETB/month</p>
              </div>
              <span class="bg-success/20 text-success px-2 py-1 rounded text-xs">Active</span>
            </div>
            <div class="flex justify-between items-center">
              <span class="text-sm">Next payout: Dec 30</span>
              <button onclick="joinEkub('laptop-fund')" class="bg-primary text-black px-3 py-1 rounded text-sm font-semibold">Join</button>
            </div>
          </div>
          
          <div class="bg-white/5 rounded-lg p-3 mb-3">
            <div class="flex justify-between items-start mb-2">
              <div>
                <h4 class="font-semibold">Business Startup</h4>
                <p class="text-xs text-gray-400">8/10 members ‚Ä¢ 5,000 ETB/month</p>
              </div>
              <span class="bg-yellow-500/20 text-yellow-400 px-2 py-1 rounded text-xs">Filling</span>
            </div>
            <div class="flex justify-between items-center">
              <span class="text-sm">Starts: Jan 15</span>
              <button onclick="joinEkub('business-startup')" class="bg-primary text-black px-3 py-1 rounded text-sm font-semibold">Join</button>
            </div>
          </div>
        </div>
      </div>

      <!-- Transactions -->
      <div class="glass rounded-xl p-4 mb-20">
        <h3 class="font-bold mb-4">üìã Recent Transactions</h3>
        <div id="transactions-list">
          <!-- Transactions will be populated here -->
        </div>
      </div>
    </div>

    <!-- Profile Page -->
    <div id="profile-page" class="page">
      <div class="flex items-center justify-between mb-6">
        <h1 class="text-2xl font-bold">üë§ My Profile</h1>
        <button onclick="showEditProfileModal()" class="bg-primary/20 p-2 rounded-lg">‚úèÔ∏è</button>
      </div>

      <!-- Profile Card -->
      <div class="glass rounded-xl p-6 mb-6">
        <div class="flex items-center gap-4 mb-4">
          <div class="w-20 h-20 bg-gradient-to-r from-primary to-secondary rounded-full flex items-center justify-center text-2xl font-bold text-black" id="profile-avatar">
            üë§
          </div>
          <div>
            <h2 class="text-xl font-bold" id="profile-name">User</h2>
            <p class="text-gray-400" id="profile-email">user@example.com</p>
            <div class="flex items-center gap-2 mt-1">
              <span class="bg-success/20 text-success px-2 py-1 rounded text-xs" id="profile-level">Level 1</span>
              <span class="text-accent text-sm" id="profile-xp">0 XP</span>
            </div>
          </div>
        </div>
        
        <div class="bg-white/5 rounded-lg p-3">
          <div class="flex justify-between items-center mb-2">
            <span class="text-sm">Profile Strength</span>
            <span class="text-sm font-bold" id="profile-strength">0%</span>
          </div>
          <div class="w-full bg-gray-700 rounded-full h-2">
            <div class="bg-gradient-to-r from-primary to-success h-2 rounded-full" id="profile-progress" style="width: 0%"></div>
          </div>
        </div>
      </div>

      <!-- Profile Sections -->
      <div class="space-y-4 mb-20">
        <div class="glass rounded-xl p-4">
          <h3 class="font-bold mb-3">üéØ Skills & Projects</h3>
          <div id="skills-list" class="mb-4">
            <!-- Skills will be populated here -->
          </div>
          <button onclick="showModal('add-skill')" class="w-full bg-primary/20 p-3 rounded-lg text-sm">+ Add Skill</button>
        </div>

        <div class="glass rounded-xl p-4">
          <h3 class="font-bold mb-3">üèÜ Achievements</h3>
          <div class="grid grid-cols-3 gap-3" id="achievements-list">
            <!-- Achievements will be populated here -->
          </div>
        </div>

        <div class="glass rounded-xl p-4">
          <h3 class="font-bold mb-3">‚öôÔ∏è Settings</h3>
          <div class="space-y-3">
            <button onclick="toggleNotifications()" class="w-full text-left p-3 bg-white/5 rounded-lg flex justify-between items-center">
              <span>üîî Notifications</span>
              <span class="text-primary" id="notifications-status">On</span>
            </button>
            <button onclick="showModal('security')" class="w-full text-left p-3 bg-white/5 rounded-lg flex justify-between items-center">
              <span>üîê Security</span>
              <span class="text-gray-400">‚Üí</span>
            </button>
            <button onclick="logout()" class="w-full bg-red-500/20 text-red-400 p-3 rounded-lg font-semibold">
              üö™ Sign Out
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Modals -->
    <!-- Login Modal -->
    <div id="login-modal" class="modal fixed inset-0 bg-black/80 backdrop-blur-sm items-center justify-center z-50">
      <div class="glass rounded-2xl p-6 max-w-sm w-full mx-4">
        <h3 class="text-2xl font-bold mb-6 text-center bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent">Welcome Back</h3>
        <form onsubmit="handleLogin(event)">
          <div class="mb-4">
            <label class="block text-sm font-medium mb-2">Email</label>
            <input type="email" id="login-email" class="w-full p-4 bg-white/10 rounded-xl border border-white/20 focus:border-primary focus:outline-none" required>
          </div>
          <div class="mb-6">
            <label class="block text-sm font-medium mb-2">Password</label>
            <input type="password" id="login-password" class="w-full p-4 bg-white/10 rounded-xl border border-white/20 focus:border-primary focus:outline-none" required>
          </div>
          <div class="flex gap-3">
            <button type="submit" class="flex-1 bg-gradient-to-r from-primary to-blue-500 py-3 rounded-xl font-bold">Sign In</button>
            <button type="button" onclick="hideModal('login')" class="flex-1 bg-gray-600 py-3 rounded-xl font-bold">Cancel</button>
          </div>
        </form>
        <p class="mt-4 text-xs text-center text-gray-400">Demo: demo@temariware.com / demo123</p>
      </div>
    </div>

    <!-- Register Modal -->
    <div id="register-modal" class="modal fixed inset-0 bg-black/80 backdrop-blur-sm items-center justify-center z-50">
      <div class="glass rounded-2xl p-6 max-w-sm w-full mx-4">
        <h3 class="text-2xl font-bold mb-6 text-center bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent">Join TemariWare</h3>
        <form onsubmit="handleRegister(event)">
          <div class="mb-4">
            <label class="block text-sm font-medium mb-2">Full Name</label>
            <input type="text" id="register-name" class="w-full p-4 bg-white/10 rounded-xl border border-white/20 focus:border-primary focus:outline-none" required>
          </div>
          <div class="mb-4">
            <label class="block text-sm font-medium mb-2">Email</label>
            <input type="email" id="register-email" class="w-full p-4 bg-white/10 rounded-xl border border-white/20 focus:border-primary focus:outline-none" required>
          </div>
          <div class="mb-4">
            <label class="block text-sm font-medium mb-2">University</label>
            <select id="register-university" class="w-full p-4 bg-white/10 rounded-xl border border-white/20 focus:border-primary focus:outline-none" required>
              <option value="">Select University</option>
              <option value="Addis Ababa University">Addis Ababa University</option>
              <option value="Jimma University">Jimma University</option>
              <option value="Bahir Dar University">Bahir Dar University</option>
            </select>
          </div>
          <div class="mb-6">
            <label class="block text-sm font-medium mb-2">Password</label>
            <input type="password" id="register-password" class="w-full p-4 bg-white/10 rounded-xl border border-white/20 focus:border-primary focus:outline-none" required>
          </div>
          <div class="flex gap-3">
            <button type="submit" class="flex-1 bg-gradient-to-r from-primary to-blue-500 py-3 rounded-xl font-bold">Register</button>
            <button type="button" onclick="hideModal('register')" class="flex-1 bg-gray-600 py-3 rounded-xl font-bold">Cancel</button>
          </div>
        </form>
      </div>
    </div>

  </div>

  <script>
    // Global State
    let currentUser = null;
    let currentPage = 'home';
    let jobs = [];
    let courses = [];
    let ekubs = [];
    let transactions = [];

    // Initialize App
    function initApp() {
      loadUserData();
      loadJobs();
      loadCourses();
      updateUI();
    }

    // User Management
    function loadUserData() {
      const userData = localStorage.getItem('temariware_user');
      if (userData) {
        currentUser = JSON.parse(userData);
        updateUserUI();
      }
    }

    function saveUserData() {
      if (currentUser) {
        localStorage.setItem('temariware_user', JSON.stringify(currentUser));
      }
    }

    function updateUserUI() {
      if (!currentUser) return;
      
      document.getElementById('user-name').textContent = currentUser.name;
      document.getElementById('user-headline').textContent = currentUser.headline || 'Student';
      document.getElementById('balance-display').textContent = `${currentUser.walletBalance || 0} ETB`;
      document.getElementById('user-xp').textContent = currentUser.xp || 0;
      document.getElementById('user-level').textContent = currentUser.level || 1;
      document.getElementById('user-streak').textContent = currentUser.streak || 0;
      
      // Update profile page
      document.getElementById('profile-name').textContent = currentUser.name;
      document.getElementById('profile-email').textContent = currentUser.email;
      document.getElementById('profile-level').textContent = `Level ${currentUser.level || 1}`;
      document.getElementById('profile-xp').textContent = `${currentUser.xp || 0} XP`;
      document.getElementById('profile-strength').textContent = `${currentUser.profileStrength || 0}%`;
      document.getElementById('profile-progress').style.width = `${currentUser.profileStrength || 0}%`;
      
      // Update wallet
      document.getElementById('wallet-balance').textContent = `${currentUser.walletBalance || 0} ETB`;
      
      // Hide auth section if logged in
      document.getElementById('auth-section').style.display = currentUser ? 'none' : 'block';
      
      // Update applications and courses
      updateMyApplications();
      updateMyCourses();
      updateTransactionsList();
    }

    function updateMyApplications() {
      const container = document.getElementById('my-applications');
      if (!currentUser || !currentUser.appliedJobs || currentUser.appliedJobs.length === 0) {
        container.innerHTML = '<p class="text-gray-400 text-sm">No applications yet</p>';
        return;
      }
      
      container.innerHTML = currentUser.appliedJobs.slice(0, 3).map(app => `
        <div class="bg-white/5 rounded-lg p-3 mb-2">
          <div class="flex justify-between items-start">
            <div>
              <h4 class="font-semibold text-sm">${app.jobTitle}</h4>
              <p class="text-gray-400 text-xs">${app.company}</p>
            </div>
            <span class="bg-yellow-500/20 text-yellow-400 px-2 py-1 rounded text-xs">${app.status}</span>
          </div>
          <p class="text-xs text-gray-400 mt-1">Applied ${app.appliedAt}</p>
        </div>
      `).join('');
    }

    function updateMyCourses() {
      const container = document.getElementById('my-courses');
      if (!currentUser || !currentUser.enrolledCourses || currentUser.enrolledCourses.length === 0) {
        container.innerHTML = '<p class="text-gray-400 text-sm">No courses enrolled</p>';
        return;
      }
      
      container.innerHTML = currentUser.enrolledCourses.slice(0, 3).map(course => `
        <div class="bg-white/5 rounded-lg p-3 mb-2">
          <div class="flex justify-between items-start">
            <div>
              <h4 class="font-semibold text-sm">${course.title}</h4>
              <p class="text-gray-400 text-xs">by ${course.instructor}</p>
            </div>
            <span class="bg-primary/20 text-primary px-2 py-1 rounded text-xs">${course.progress || 0}%</span>
          </div>
          <div class="w-full bg-gray-700 rounded-full h-1 mt-2">
            <div class="bg-primary h-1 rounded-full" style="width: ${course.progress || 0}%"></div>
          </div>
        </div>
      `).join('');
    }

    function updateTransactionsList() {
      const container = document.getElementById('transactions-list');
      if (!transactions || transactions.length === 0) {
        container.innerHTML = '<p class="text-gray-400 text-sm">No transactions yet</p>';
        return;
      }
      
      container.innerHTML = transactions.slice(0, 5).map(tx => `
        <div class="flex justify-between items-center p-3 bg-white/5 rounded-lg mb-2">
          <div class="flex items-center gap-3">
            <div class="w-8 h-8 bg-${tx.type === 'Credit' ? 'success' : 'red-500'} rounded-full flex items-center justify-center text-sm">
              ${tx.type === 'Credit' ? '+' : '-'}
            </div>
            <div>
              <p class="font-semibold text-sm">${tx.description}</p>
              <p class="text-xs text-gray-400">${tx.date}</p>
            </div>
          </div>
          <span class="text-${tx.type === 'Credit' ? 'success' : 'red-400'} font-bold">
            ${tx.type === 'Credit' ? '+' : '-'}${tx.amount} ETB
          </span>
        </div>
      `).join('');
    }

    // Authentication
    function handleLogin(event) {
      event.preventDefault();
      const email = document.getElementById('login-email').value;
      const password = document.getElementById('login-password').value;

      // Demo login
      if (email === 'demo@temariware.com' && password === 'demo123') {
        currentUser = {
          id: 'demo-user',
          name: 'Abebe Kebede',
          email: email,
          headline: 'Full Stack Developer | CS Senior @ AAU',
          university: 'Addis Ababa University',
          walletBalance: 2450,
          xp: 1250,
          level: 5,
          streak: 3,
          profileStrength: 85,
          skills: ['React', 'TypeScript', 'Python'],
          achievements: ['üî•', 'üíº', 'üìö']
        };
        saveUserData();
        updateUserUI();
        hideModal('login');
        showNotification('‚úÖ Welcome back, Abebe!', 'success');
      } else {
        showNotification('‚ùå Invalid credentials', 'error');
      }
    }

    function handleRegister(event) {
      event.preventDefault();
      const name = document.getElementById('register-name').value;
      const email = document.getElementById('register-email').value;
      const university = document.getElementById('register-university').value;
      
      currentUser = {
        id: 'new-user-' + Date.now(),
        name: name,
        email: email,
        university: university,
        walletBalance: 500, // Welcome bonus
        xp: 0,
        level: 1,
        streak: 0,
        profileStrength: 25,
        skills: [],
        achievements: []
      };
      
      saveUserData();
      updateUserUI();
      hideModal('register');
      showNotification('üéâ Welcome to TemariWare!', 'success');
    }

    function logout() {
      currentUser = null;
      localStorage.removeItem('temariware_user');
      location.reload();
    }

    // Jobs Management
    function loadJobs() {
      jobs = [
        {
          id: 'j1',
          title: 'Frontend Developer Intern',
          company: 'Ride Ethiopia',
          type: 'Internship',
          location: 'Hybrid',
          salary: '4,000 ETB/month',
          description: 'Build modern web applications using React and TypeScript. Perfect for CS students.',
          tags: ['React', 'TypeScript', 'Web'],
          postedAt: '2 days ago',
          applicants: 12
        },
        {
          id: 'j2',
          title: 'UI/UX Designer',
          company: 'Ahadoo Tec',
          type: 'Freelance',
          location: 'Remote',
          salary: '8,000 ETB/project',
          description: 'Design mobile app interfaces for fintech startup.',
          tags: ['Figma', 'Mobile', 'Design'],
          postedAt: '1 day ago',
          applicants: 8
        },
        {
          id: 'j3',
          title: 'Content Writer',
          company: 'EthioTech Blog',
          type: 'Part-time',
          location: 'Remote',
          salary: '2,500 ETB/month',
          description: 'Write tech articles in Amharic and English.',
          tags: ['Writing', 'Tech', 'Amharic'],
          postedAt: '3 hours ago',
          applicants: 3
        }
      ];
      renderJobs();
    }

    function renderJobs(filteredJobs = jobs) {
      const jobsList = document.getElementById('jobs-list');
      jobsList.innerHTML = filteredJobs.map(job => `
        <div class="glass rounded-xl p-4">
          <div class="flex justify-between items-start mb-2">
            <h3 class="font-bold text-lg">${job.title}</h3>
            <span class="bg-primary/20 text-primary px-2 py-1 rounded text-xs">${job.type}</span>
          </div>
          <p class="text-gray-400 text-sm mb-2">${job.company} ‚Ä¢ ${job.location}</p>
          <p class="text-sm mb-3">${job.description}</p>
          <div class="flex flex-wrap gap-1 mb-3">
            ${job.tags.map(tag => `<span class="bg-white/10 px-2 py-1 rounded text-xs">${tag}</span>`).join('')}
          </div>
          <div class="flex justify-between items-center">
            <div>
              <span class="text-primary font-bold">${job.salary}</span>
              <span class="text-gray-400 text-sm ml-2">${job.applicants} applied</span>
            </div>
            <button onclick="applyToJob('${job.id}')" class="bg-primary text-black px-4 py-2 rounded-lg font-semibold">Apply</button>
          </div>
        </div>
      `).join('');
    }

    function applyToJob(jobId) {
      if (!currentUser) {
        showNotification('üîí Please sign in to apply', 'warning');
        showModal('login');
        return;
      }
      
      const job = jobs.find(j => j.id === jobId);
      if (job) {
        showJobApplicationModal(job);
      }
    }

    function showJobApplicationModal(job) {
      const modal = document.createElement('div');
      modal.className = 'modal active fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50';
      modal.innerHTML = `
        <div class="glass rounded-2xl p-6 max-w-md w-full mx-4">
          <h3 class="text-xl font-bold mb-4">Apply to ${job.title}</h3>
          <div class="mb-4">
            <p class="text-gray-400 mb-2">${job.company} ‚Ä¢ ${job.salary}</p>
            <p class="text-sm mb-4">${job.description}</p>
          </div>
          <form onsubmit="submitJobApplication(event, '${job.id}')">
            <div class="mb-4">
              <label class="block text-sm font-medium mb-2">Cover Letter</label>
              <textarea id="cover-letter" class="w-full p-3 bg-white/10 rounded-xl border border-white/20 focus:border-primary focus:outline-none" rows="4" placeholder="Why are you interested in this position?" required></textarea>
            </div>
            <div class="mb-4">
              <label class="block text-sm font-medium mb-2">Resume/CV</label>
              <input type="file" class="w-full p-3 bg-white/10 rounded-xl border border-white/20" accept=".pdf,.doc,.docx">
            </div>
            <div class="mb-6">
              <label class="block text-sm font-medium mb-2">Expected Salary</label>
              <input type="number" class="w-full p-3 bg-white/10 rounded-xl border border-white/20 focus:border-primary focus:outline-none" placeholder="Amount in ETB">
            </div>
            <div class="flex gap-3">
              <button type="submit" class="flex-1 bg-primary text-black py-3 rounded-xl font-bold">Submit Application</button>
              <button type="button" onclick="this.closest('.modal').remove()" class="flex-1 bg-gray-600 py-3 rounded-xl font-bold">Cancel</button>
            </div>
          </form>
        </div>
      `;
      document.body.appendChild(modal);
    }

    function submitJobApplication(event, jobId) {
      event.preventDefault();
      const coverLetter = document.getElementById('cover-letter').value;
      
      if (!coverLetter.trim()) {
        showNotification('‚ùå Please write a cover letter', 'error');
        return;
      }
      
      const job = jobs.find(j => j.id === jobId);
      job.applicants++;
      
      // Add to user's applied jobs
      if (!currentUser.appliedJobs) currentUser.appliedJobs = [];
      currentUser.appliedJobs.push({
        jobId: jobId,
        jobTitle: job.title,
        company: job.company,
        status: 'Applied',
        appliedAt: new Date().toLocaleDateString(),
        coverLetter: coverLetter
      });
      
      currentUser.xp += 10;
      saveUserData();
      updateUserUI();
      
      event.target.closest('.modal').remove();
      showNotification(`‚úÖ Application submitted to ${job.company}!`, 'success');
      renderJobs();
      
      // Show application tracking
      setTimeout(() => {
        showNotification('üìß You will receive updates via email', 'info');
      }, 2000);
    }

    function filterJobs(filter) {
      document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('bg-primary/20'));
      event.target.classList.add('bg-primary/20');
      
      if (filter === 'all') {
        renderJobs();
      } else {
        const filtered = jobs.filter(job => job.type === filter || job.location === filter);
        renderJobs(filtered);
      }
    }

    function searchJobs(query) {
      if (!query) {
        renderJobs();
        return;
      }
      
      const filtered = jobs.filter(job => 
        job.title.toLowerCase().includes(query.toLowerCase()) ||
        job.company.toLowerCase().includes(query.toLowerCase()) ||
        job.tags.some(tag => tag.toLowerCase().includes(query.toLowerCase()))
      );
      renderJobs(filtered);
    }

    // Courses Management
    function loadCourses() {
      courses = [
        {
          id: 'c1',
          title: 'React Development Masterclass',
          instructor: 'Sara Tadesse',
          price: 500,
          category: 'Development',
          rating: 4.8,
          students: 120,
          duration: '4 weeks',
          description: 'Learn modern React with hooks, context, and best practices.'
        },
        {
          id: 'c2',
          title: 'UI/UX Design with Figma',
          instructor: 'Michael Belay',
          price: 0,
          category: 'Design',
          rating: 4.9,
          students: 89,
          duration: '3 weeks',
          description: 'Master interface design and user experience principles.'
        },
        {
          id: 'c3',
          title: 'Digital Marketing for Startups',
          instructor: 'Hanan Ahmed',
          price: 800,
          category: 'Business',
          rating: 4.7,
          students: 67,
          duration: '6 weeks',
          description: 'Learn social media marketing and growth strategies.'
        }
      ];
      renderCourses();
    }

    function renderCourses(filteredCourses = courses) {
      const coursesList = document.getElementById('courses-list');
      coursesList.innerHTML = filteredCourses.map(course => `
        <div class="glass rounded-xl p-4">
          <div class="flex items-start gap-3">
            <div class="w-16 h-16 bg-gradient-to-r from-blue-500 to-purple-500 rounded-lg flex items-center justify-center text-2xl">
              ${course.category === 'Design' ? 'üé®' : course.category === 'Development' ? 'üíª' : 'üìà'}
            </div>
            <div class="flex-1">
              <h3 class="font-bold text-lg mb-1">${course.title}</h3>
              <p class="text-gray-400 text-sm mb-2">by ${course.instructor} ‚Ä¢ ${course.duration}</p>
              <p class="text-sm mb-3">${course.description}</p>
              <div class="flex justify-between items-center">
                <div>
                  <span class="text-${course.price === 0 ? 'success' : 'accent'} font-bold">
                    ${course.price === 0 ? 'Free' : course.price + ' ETB'}
                  </span>
                  <span class="text-gray-400 text-sm ml-2">‚≠ê ${course.rating} (${course.students})</span>
                </div>
                <button onclick="enrollInCourse('${course.id}')" class="bg-primary text-black px-4 py-2 rounded-lg font-semibold">Enroll</button>
              </div>
            </div>
          </div>
        </div>
      `).join('');
    }

    function enrollInCourse(courseId) {
      if (!currentUser) {
        showNotification('üîí Please sign in to enroll', 'warning');
        showModal('login');
        return;
      }
      
      const course = courses.find(c => c.id === courseId);
      if (course) {
        showCourseEnrollmentModal(course);
      }
    }

    function showCourseEnrollmentModal(course) {
      const modal = document.createElement('div');
      modal.className = 'modal active fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50';
      modal.innerHTML = `
        <div class="glass rounded-2xl p-6 max-w-md w-full mx-4">
          <h3 class="text-xl font-bold mb-4">Enroll in ${course.title}</h3>
          <div class="mb-4">
            <p class="text-gray-400 mb-2">by ${course.instructor} ‚Ä¢ ${course.duration}</p>
            <p class="text-sm mb-4">${course.description}</p>
            <div class="bg-white/5 rounded-lg p-3 mb-4">
              <div class="flex justify-between items-center">
                <span>Course Fee:</span>
                <span class="font-bold text-${course.price === 0 ? 'success' : 'accent'}">
                  ${course.price === 0 ? 'FREE' : course.price + ' ETB'}
                </span>
              </div>
              ${course.price > 0 ? `
                <div class="flex justify-between items-center mt-2">
                  <span>Your Balance:</span>
                  <span class="font-bold ${currentUser.walletBalance >= course.price ? 'text-success' : 'text-red-400'}">
                    ${currentUser.walletBalance} ETB
                  </span>
                </div>
              ` : ''}
            </div>
          </div>
          <div class="mb-6">
            <label class="flex items-center gap-2">
              <input type="checkbox" id="terms-checkbox" class="rounded">
              <span class="text-sm">I agree to the course terms and conditions</span>
            </label>
          </div>
          <div class="flex gap-3">
            <button onclick="confirmCourseEnrollment('${course.id}')" class="flex-1 bg-primary text-black py-3 rounded-xl font-bold">Confirm Enrollment</button>
            <button onclick="this.closest('.modal').remove()" class="flex-1 bg-gray-600 py-3 rounded-xl font-bold">Cancel</button>
          </div>
        </div>
      `;
      document.body.appendChild(modal);
    }

    function confirmCourseEnrollment(courseId) {
      const termsChecked = document.getElementById('terms-checkbox').checked;
      if (!termsChecked) {
        showNotification('‚ùå Please accept the terms and conditions', 'error');
        return;
      }
      
      const course = courses.find(c => c.id === courseId);
      
      if (course.price > 0 && currentUser.walletBalance < course.price) {
        showNotification('üí∞ Insufficient balance. Please add funds to your wallet.', 'error');
        return;
      }
      
      if (course.price > 0) {
        currentUser.walletBalance -= course.price;
        transactions.unshift({
          id: 't' + Date.now(),
          type: 'Debit',
          amount: course.price,
          description: `Course Enrollment: ${course.title}`,
          date: new Date().toLocaleDateString(),
          status: 'Completed'
        });
      }
      
      // Add to enrolled courses with direct access
      if (!currentUser.enrolledCourses) currentUser.enrolledCourses = [];
      currentUser.enrolledCourses.push({
        courseId: courseId,
        title: course.title,
        instructor: course.instructor,
        enrolledAt: new Date().toLocaleDateString(),
        progress: 0,
        status: 'Active',
        accessUrl: `#course-${courseId}` // Direct access link
      });
      
      course.students++;
      currentUser.xp += 25;
      saveUserData();
      updateUserUI();
      
      document.querySelector('.modal.active').remove();
      showNotification(`üéì Successfully enrolled in ${course.title}!`, 'success');
      renderCourses();
      
      // Show course access with direct link
      setTimeout(() => {
        const accessModal = document.createElement('div');
        accessModal.className = 'modal active fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50';
        accessModal.innerHTML = `
          <div class="glass rounded-2xl p-6 max-w-md w-full mx-4 text-center">
            <div class="text-6xl mb-4">üéì</div>
            <h3 class="text-xl font-bold mb-4">Welcome to ${course.title}!</h3>
            <p class="text-gray-400 mb-6">Your course materials are now ready</p>
            <div class="space-y-3">
              <button onclick="accessCourse('${courseId}')" class="w-full bg-primary text-black py-3 rounded-xl font-bold">üìö Start Learning</button>
              <button onclick="this.closest('.modal').remove()" class="w-full bg-white/10 py-3 rounded-xl font-bold">Later</button>
            </div>
          </div>
        `;
        document.body.appendChild(accessModal);
      }, 1500);
    }

    function accessCourse(courseId) {
      document.querySelector('.modal.active')?.remove();
      
      const course = courses.find(c => c.id === courseId);
      const modal = document.createElement('div');
      modal.className = 'modal active fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50';
      modal.innerHTML = `
        <div class="glass rounded-2xl p-6 max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto">
          <div class="flex justify-between items-center mb-6">
            <h3 class="text-xl font-bold">üìö ${course.title}</h3>
            <button onclick="this.closest('.modal').remove()" class="bg-gray-600 px-3 py-1 rounded">√ó</button>
          </div>
          
          <!-- Course Progress -->
          <div class="bg-white/5 rounded-lg p-4 mb-6">
            <div class="flex justify-between items-center mb-2">
              <span>Progress</span>
              <span class="font-bold">0%</span>
            </div>
            <div class="w-full bg-gray-700 rounded-full h-2">
              <div class="bg-primary h-2 rounded-full" style="width: 0%"></div>
            </div>
          </div>
          
          <!-- Course Modules -->
          <div class="space-y-4">
            <div class="bg-white/5 rounded-lg p-4">
              <h4 class="font-bold mb-3">üìù Module 1: Introduction</h4>
              <div class="space-y-2">
                <div class="flex items-center gap-3 p-2 bg-white/5 rounded">
                  <div class="w-8 h-8 bg-primary rounded-full flex items-center justify-center text-black font-bold text-sm">1</div>
                  <div class="flex-1">
                    <p class="font-semibold">Welcome & Course Overview</p>
                    <p class="text-xs text-gray-400">5 min video</p>
                  </div>
                  <button onclick="playLesson('intro-1')" class="bg-primary text-black px-3 py-1 rounded text-sm">‚ñ∂Ô∏è Play</button>
                </div>
                <div class="flex items-center gap-3 p-2 bg-white/5 rounded opacity-50">
                  <div class="w-8 h-8 bg-gray-600 rounded-full flex items-center justify-center text-white font-bold text-sm">2</div>
                  <div class="flex-1">
                    <p class="font-semibold">Setting Up Your Environment</p>
                    <p class="text-xs text-gray-400">12 min video</p>
                  </div>
                  <span class="text-gray-400 text-sm">üîí Locked</span>
                </div>
              </div>
            </div>
            
            <div class="bg-white/5 rounded-lg p-4 opacity-50">
              <h4 class="font-bold mb-3">üìù Module 2: Fundamentals</h4>
              <p class="text-sm text-gray-400">Complete Module 1 to unlock</p>
            </div>
          </div>
          
          <!-- Course Resources -->
          <div class="mt-6 bg-blue-500/20 rounded-lg p-4">
            <h4 class="font-bold mb-2">üìé Course Resources</h4>
            <div class="space-y-2">
              <a href="#" class="block text-blue-400 hover:text-blue-300 text-sm">üìÑ Course Slides (PDF)</a>
              <a href="#" class="block text-blue-400 hover:text-blue-300 text-sm">üíª Code Examples (GitHub)</a>
              <a href="#" class="block text-blue-400 hover:text-blue-300 text-sm">üí¨ Discussion Forum</a>
            </div>
          </div>
        </div>
      `;
      document.body.appendChild(modal);
    }

    function playLesson(lessonId) {
      showNotification('üé• Loading lesson...', 'info');
      
      // Update progress
      const enrolledCourse = currentUser.enrolledCourses.find(c => c.courseId === lessonId.split('-')[0]);
      if (enrolledCourse) {
        enrolledCourse.progress = 10;
        currentUser.xp = (currentUser.xp || 0) + 15;
        saveUserData();
        updateUserUI();
      }
      
      setTimeout(() => {
        showNotification('‚úÖ Lesson completed! +15 XP', 'success');
      }, 2000);
    }

    function filterCourses(filter) {
      document.querySelectorAll('.course-filter-btn').forEach(btn => btn.classList.remove('bg-primary/20'));
      event.target.classList.add('bg-primary/20');
      
      if (filter === 'all') {
        renderCourses();
      } else {
        const filtered = courses.filter(course => course.category === filter);
        renderCourses(filtered);
      }
    }

    // Wallet & Ekub Management
    function claimDailyReward() {
      if (!currentUser) {
        showNotification('üîí Please sign in first', 'warning');
        showModal('login');
        return;
      }
      
      const today = new Date().toDateString();
      if (currentUser.lastClaimDate === today) {
        showNotification('‚è∞ Already claimed today! Come back tomorrow.', 'warning');
        return;
      }
      
      // Show claim animation modal
      const modal = document.createElement('div');
      modal.className = 'modal active fixed inset-0 bg-black/90 backdrop-blur-sm flex items-center justify-center z-50';
      modal.innerHTML = `
        <div class="glass rounded-2xl p-8 max-w-sm w-full mx-4 text-center">
          <div class="text-8xl mb-4 animate-bounce">üéÅ</div>
          <h3 class="text-2xl font-bold mb-4">Daily Reward!</h3>
          <div class="bg-gradient-to-r from-accent/20 to-orange-500/20 rounded-xl p-4 mb-6">
            <div class="text-3xl font-bold text-accent mb-2">+150 ETB</div>
            <div class="text-sm text-gray-300">Base reward</div>
          </div>
          <div class="space-y-2 mb-6">
            <div class="flex justify-between items-center">
              <span>Streak Bonus (${currentUser.streak || 0} days):</span>
              <span class="text-primary font-bold">+${(currentUser.streak || 0) * 10} ETB</span>
            </div>
            <div class="flex justify-between items-center">
              <span>Level Bonus (Lv.${currentUser.level || 1}):</span>
              <span class="text-secondary font-bold">+${(currentUser.level || 1) * 5} ETB</span>
            </div>
            <hr class="border-white/20">
            <div class="flex justify-between items-center font-bold text-lg">
              <span>Total:</span>
              <span class="text-success">+${150 + ((currentUser.streak || 0) * 10) + ((currentUser.level || 1) * 5)} ETB</span>
            </div>
          </div>
          <button onclick="processDailyClaim()" class="w-full bg-gradient-to-r from-accent to-orange-500 py-3 rounded-xl font-bold text-lg">
            Claim Reward! üéâ
          </button>
        </div>
      `;
      document.body.appendChild(modal);
    }

    function processDailyClaim() {
      const totalReward = 150 + ((currentUser.streak || 0) * 10) + ((currentUser.level || 1) * 5);
      
      currentUser.walletBalance += totalReward;
      currentUser.xp += 25;
      currentUser.streak = (currentUser.streak || 0) + 1;
      currentUser.lastClaimDate = new Date().toDateString();
      
      // Check for level up
      const newLevel = Math.floor((currentUser.xp || 0) / 250) + 1;
      const leveledUp = newLevel > (currentUser.level || 1);
      currentUser.level = newLevel;
      
      transactions.unshift({
        id: 't' + Date.now(),
        type: 'Credit',
        amount: totalReward,
        description: `Daily Bonus (${currentUser.streak} day streak)`,
        date: new Date().toLocaleDateString(),
        status: 'Completed'
      });
      
      saveUserData();
      updateUserUI();
      document.querySelector('.modal.active').remove();
      
      showNotification(`üéÅ Claimed ${totalReward} ETB! Streak: ${currentUser.streak} days`, 'success');
      
      if (leveledUp) {
        setTimeout(() => {
          showNotification(`üéâ Level Up! You're now Level ${currentUser.level}!`, 'success');
        }, 1000);
      }
    }

    // Navigation
    function showPage(page) {
      document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
      document.getElementById(page + '-page').classList.add('active');
      
      document.querySelectorAll('.nav-btn').forEach(btn => {
        btn.classList.remove('bg-primary/20');
        if (btn.dataset.page === page) {
          btn.classList.add('bg-primary/20');
        }
      });
      
      currentPage = page;
    }

    function showModal(modalName) {
      document.getElementById(modalName + '-modal').classList.add('active');
    }

    function hideModal(modalName) {
      document.getElementById(modalName + '-modal').classList.remove('active');
    }

    // Wallet Functions
    function showSendMoneyFlow() {
      if (!currentUser) {
        showNotification('üîí Please sign in first', 'warning');
        showModal('login');
        return;
      }
      
      const modal = document.createElement('div');
      modal.className = 'modal active fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50';
      modal.innerHTML = `
        <div class="glass rounded-2xl p-6 max-w-sm w-full mx-4">
          <h3 class="text-xl font-bold mb-4">üí∏ Send Money</h3>
          <form onsubmit="processSendMoney(event)">
            <div class="mb-4">
              <label class="block text-sm font-medium mb-2">Recipient</label>
              <input type="text" id="recipient" class="w-full p-3 bg-white/10 rounded-xl border border-white/20 focus:border-primary focus:outline-none" placeholder="Phone number or email" required>
            </div>
            <div class="mb-4">
              <label class="block text-sm font-medium mb-2">Amount (ETB)</label>
              <input type="number" id="send-amount" class="w-full p-3 bg-white/10 rounded-xl border border-white/20 focus:border-primary focus:outline-none" placeholder="0.00" min="1" max="${currentUser.walletBalance}" required>
            </div>
            <div class="mb-4">
              <label class="block text-sm font-medium mb-2">Payment Method</label>
              <select class="w-full p-3 bg-white/10 rounded-xl border border-white/20 focus:border-primary focus:outline-none">
                <option>Wallet Balance</option>
                <option>Telebirr</option>
                <option>CBE Birr</option>
              </select>
            </div>
            <div class="mb-6">
              <label class="block text-sm font-medium mb-2">Note (Optional)</label>
              <input type="text" class="w-full p-3 bg-white/10 rounded-xl border border-white/20 focus:border-primary focus:outline-none" placeholder="Payment for...">
            </div>
            <div class="flex gap-3">
              <button type="submit" class="flex-1 bg-success py-3 rounded-xl font-bold">Send Money</button>
              <button type="button" onclick="this.closest('.modal').remove()" class="flex-1 bg-gray-600 py-3 rounded-xl font-bold">Cancel</button>
            </div>
          </form>
        </div>
      `;
      document.body.appendChild(modal);
    }

    function processSendMoney(event) {
      event.preventDefault();
      const recipient = document.getElementById('recipient').value;
      const amount = parseFloat(document.getElementById('send-amount').value);
      
      if (amount > currentUser.walletBalance) {
        showNotification('üí∞ Insufficient balance', 'error');
        return;
      }
      
      currentUser.walletBalance -= amount;
      transactions.unshift({
        id: 't' + Date.now(),
        type: 'Debit',
        amount: amount,
        description: `Sent to ${recipient}`,
        date: new Date().toLocaleDateString(),
        status: 'Completed'
      });
      
      saveUserData();
      updateUserUI();
      event.target.closest('.modal').remove();
      showNotification(`‚úÖ ${amount} ETB sent successfully!`, 'success');
    }

    function showAddFundsFlow() {
      const modal = document.createElement('div');
      modal.className = 'modal active fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50';
      modal.innerHTML = `
        <div class="glass rounded-2xl p-6 max-w-sm w-full mx-4">
          <h3 class="text-xl font-bold mb-4">üí≥ Add Funds</h3>
          <div class="space-y-3">
            <button onclick="addFundsMethod('telebirr')" class="w-full bg-blue-600 p-4 rounded-xl text-left flex items-center gap-3">
              <div class="w-10 h-10 bg-white rounded-lg flex items-center justify-center text-blue-600 font-bold">T</div>
              <div>
                <div class="font-bold">Telebirr</div>
                <div class="text-sm text-gray-300">Mobile payment</div>
              </div>
            </button>
            <button onclick="addFundsMethod('cbe')" class="w-full bg-green-600 p-4 rounded-xl text-left flex items-center gap-3">
              <div class="w-10 h-10 bg-white rounded-lg flex items-center justify-center text-green-600 font-bold">C</div>
              <div>
                <div class="font-bold">CBE Birr</div>
                <div class="text-sm text-gray-300">Bank transfer</div>
              </div>
            </button>
            <button onclick="addFundsMethod('bank')" class="w-full bg-purple-600 p-4 rounded-xl text-left flex items-center gap-3">
              <div class="w-10 h-10 bg-white rounded-lg flex items-center justify-center text-purple-600 font-bold">B</div>
              <div>
                <div class="font-bold">Bank Transfer</div>
                <div class="text-sm text-gray-300">Direct deposit</div>
              </div>
            </button>
          </div>
          <button onclick="this.closest('.modal').remove()" class="w-full mt-4 bg-gray-600 py-3 rounded-xl font-bold">Cancel</button>
        </div>
      `;
      document.body.appendChild(modal);
    }

    function addFundsMethod(method) {
      document.querySelector('.modal.active').remove();
      
      const modal = document.createElement('div');
      modal.className = 'modal active fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50';
      modal.innerHTML = `
        <div class="glass rounded-2xl p-6 max-w-sm w-full mx-4">
          <h3 class="text-xl font-bold mb-4">Add Funds via ${method.toUpperCase()}</h3>
          <form onsubmit="processAddFunds(event, '${method}')">
            <div class="mb-4">
              <label class="block text-sm font-medium mb-2">Amount (ETB)</label>
              <input type="number" id="add-amount" class="w-full p-3 bg-white/10 rounded-xl border border-white/20 focus:border-primary focus:outline-none" placeholder="0.00" min="10" required>
            </div>
            ${method === 'telebirr' ? `
              <div class="mb-4">
                <label class="block text-sm font-medium mb-2">Phone Number</label>
                <input type="tel" class="w-full p-3 bg-white/10 rounded-xl border border-white/20 focus:border-primary focus:outline-none" placeholder="+251..." required>
              </div>
            ` : ''}
            <div class="bg-yellow-500/20 border border-yellow-500/30 rounded-lg p-3 mb-4">
              <p class="text-sm text-yellow-200">‚ö†Ô∏è You will be redirected to complete the payment</p>
            </div>
            <div class="flex gap-3">
              <button type="submit" class="flex-1 bg-primary text-black py-3 rounded-xl font-bold">Continue</button>
              <button type="button" onclick="this.closest('.modal').remove()" class="flex-1 bg-gray-600 py-3 rounded-xl font-bold">Cancel</button>
            </div>
          </form>
        </div>
      `;
      document.body.appendChild(modal);
    }

    function processAddFunds(event, method) {
      event.preventDefault();
      const amount = parseFloat(document.getElementById('add-amount').value);
      
      event.target.closest('.modal').remove();
      showNotification('üîÑ Processing payment...', 'info');
      
      // Simulate payment processing
      setTimeout(() => {
        currentUser.walletBalance += amount;
        transactions.unshift({
          id: 't' + Date.now(),
          type: 'Credit',
          amount: amount,
          description: `Added funds via ${method.toUpperCase()}`,
          date: new Date().toLocaleDateString(),
          status: 'Completed'
        });
        
        saveUserData();
        updateUserUI();
        showNotification(`‚úÖ ${amount} ETB added successfully!`, 'success');
      }, 2000);
    }
    // Profile & Settings Functions
    function showEditProfileModal() {
      const modal = document.createElement('div');
      modal.className = 'modal active fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50';
      modal.innerHTML = `
        <div class="glass rounded-2xl p-6 max-w-lg w-full mx-4 max-h-[95vh] overflow-y-auto">
          <h3 class="text-xl font-bold mb-6">‚úèÔ∏è Edit Profile</h3>
          <form onsubmit="saveProfileChanges(event)">
            <!-- Profile Picture -->
            <div class="mb-6 text-center">
              <div class="w-24 h-24 bg-gradient-to-r from-primary to-secondary rounded-full flex items-center justify-center text-3xl font-bold text-black mx-auto mb-3" id="preview-avatar">
                ${currentUser.avatar || 'üë§'}
              </div>
              <input type="file" id="profile-picture" accept="image/*" onchange="previewProfilePicture(this)" class="hidden">
              <button type="button" onclick="document.getElementById('profile-picture').click()" class="bg-primary/20 px-4 py-2 rounded-lg text-sm">üì∑ Change Photo</button>
            </div>
            
            <!-- Basic Info -->
            <div class="grid grid-cols-2 gap-4 mb-4">
              <div>
                <label class="block text-sm font-medium mb-2">First Name</label>
                <input type="text" id="edit-firstname" value="${currentUser.name?.split(' ')[0] || ''}" class="w-full p-3 bg-white/10 rounded-xl border border-white/20 focus:border-primary focus:outline-none" required>
              </div>
              <div>
                <label class="block text-sm font-medium mb-2">Last Name</label>
                <input type="text" id="edit-lastname" value="${currentUser.name?.split(' ').slice(1).join(' ') || ''}" class="w-full p-3 bg-white/10 rounded-xl border border-white/20 focus:border-primary focus:outline-none" required>
              </div>
            </div>
            
            <div class="mb-4">
              <label class="block text-sm font-medium mb-2">Professional Headline</label>
              <input type="text" id="edit-headline" value="${currentUser.headline || ''}" class="w-full p-3 bg-white/10 rounded-xl border border-white/20 focus:border-primary focus:outline-none" placeholder="e.g., Full Stack Developer | CS Senior @ AAU">
            </div>
            
            <!-- Education -->
            <div class="grid grid-cols-2 gap-4 mb-4">
              <div>
                <label class="block text-sm font-medium mb-2">University</label>
                <select id="edit-university" class="w-full p-3 bg-white/10 rounded-xl border border-white/20 focus:border-primary focus:outline-none">
                  <option value="Addis Ababa University" ${currentUser.university === 'Addis Ababa University' ? 'selected' : ''}>Addis Ababa University</option>
                  <option value="Jimma University" ${currentUser.university === 'Jimma University' ? 'selected' : ''}>Jimma University</option>
                  <option value="Bahir Dar University" ${currentUser.university === 'Bahir Dar University' ? 'selected' : ''}>Bahir Dar University</option>
                  <option value="Hawassa University" ${currentUser.university === 'Hawassa University' ? 'selected' : ''}>Hawassa University</option>
                </select>
              </div>
              <div>
                <label class="block text-sm font-medium mb-2">Department</label>
                <input type="text" id="edit-department" value="${currentUser.department || ''}" class="w-full p-3 bg-white/10 rounded-xl border border-white/20 focus:border-primary focus:outline-none" placeholder="Computer Science">
              </div>
            </div>
            
            <div class="grid grid-cols-2 gap-4 mb-4">
              <div>
                <label class="block text-sm font-medium mb-2">Year of Study</label>
                <select id="edit-year" class="w-full p-3 bg-white/10 rounded-xl border border-white/20 focus:border-primary focus:outline-none">
                  <option value="1st Year" ${currentUser.yearOfStudy === '1st Year' ? 'selected' : ''}>1st Year</option>
                  <option value="2nd Year" ${currentUser.yearOfStudy === '2nd Year' ? 'selected' : ''}>2nd Year</option>
                  <option value="3rd Year" ${currentUser.yearOfStudy === '3rd Year' ? 'selected' : ''}>3rd Year</option>
                  <option value="4th Year" ${currentUser.yearOfStudy === '4th Year' ? 'selected' : ''}>4th Year</option>
                  <option value="Graduate" ${currentUser.yearOfStudy === 'Graduate' ? 'selected' : ''}>Graduate</option>
                </select>
              </div>
              <div>
                <label class="block text-sm font-medium mb-2">GPA</label>
                <input type="number" id="edit-gpa" value="${currentUser.gpa || ''}" step="0.01" min="0" max="4" class="w-full p-3 bg-white/10 rounded-xl border border-white/20 focus:border-primary focus:outline-none" placeholder="3.50">
              </div>
            </div>
            
            <!-- Contact Info -->
            <div class="grid grid-cols-2 gap-4 mb-4">
              <div>
                <label class="block text-sm font-medium mb-2">Phone Number</label>
                <input type="tel" id="edit-phone" value="${currentUser.phone || ''}" class="w-full p-3 bg-white/10 rounded-xl border border-white/20 focus:border-primary focus:outline-none" placeholder="+251...">
              </div>
              <div>
                <label class="block text-sm font-medium mb-2">Location</label>
                <input type="text" id="edit-location" value="${currentUser.location || ''}" class="w-full p-3 bg-white/10 rounded-xl border border-white/20 focus:border-primary focus:outline-none" placeholder="Addis Ababa">
              </div>
            </div>
            
            <!-- Bio -->
            <div class="mb-4">
              <label class="block text-sm font-medium mb-2">About Me</label>
              <textarea id="edit-bio" class="w-full p-3 bg-white/10 rounded-xl border border-white/20 focus:border-primary focus:outline-none" rows="4" placeholder="Tell us about yourself, your interests, and career goals...">${currentUser.bio || ''}</textarea>
            </div>
            
            <!-- Skills -->
            <div class="mb-4">
              <label class="block text-sm font-medium mb-2">Skills</label>
              <div id="skills-container" class="mb-2">
                ${(currentUser.skills || []).map((skill, index) => `
                  <div class="flex items-center gap-2 mb-2">
                    <input type="text" value="${skill}" class="flex-1 p-2 bg-white/10 rounded-lg border border-white/20 focus:border-primary focus:outline-none skill-input">
                    <select class="p-2 bg-white/10 rounded-lg border border-white/20 skill-level">
                      <option value="Beginner">Beginner</option>
                      <option value="Intermediate" selected>Intermediate</option>
                      <option value="Expert">Expert</option>
                    </select>
                    <button type="button" onclick="this.parentElement.remove()" class="bg-red-500/20 text-red-400 px-2 py-1 rounded">√ó</button>
                  </div>
                `).join('')}
              </div>
              <button type="button" onclick="addSkillField()" class="bg-primary/20 px-3 py-2 rounded-lg text-sm">+ Add Skill</button>
            </div>
            
            <!-- Social Links -->
            <div class="mb-6">
              <label class="block text-sm font-medium mb-2">Social Links</label>
              <div class="grid grid-cols-2 gap-4">
                <div>
                  <label class="block text-xs text-gray-400 mb-1">GitHub</label>
                  <input type="url" id="edit-github" value="${currentUser.socialLinks?.github || ''}" class="w-full p-2 bg-white/10 rounded-lg border border-white/20 focus:border-primary focus:outline-none" placeholder="https://github.com/username">
                </div>
                <div>
                  <label class="block text-xs text-gray-400 mb-1">LinkedIn</label>
                  <input type="url" id="edit-linkedin" value="${currentUser.socialLinks?.linkedin || ''}" class="w-full p-2 bg-white/10 rounded-lg border border-white/20 focus:border-primary focus:outline-none" placeholder="https://linkedin.com/in/username">
                </div>
                <div>
                  <label class="block text-xs text-gray-400 mb-1">Telegram</label>
                  <input type="text" id="edit-telegram" value="${currentUser.socialLinks?.telegram || ''}" class="w-full p-2 bg-white/10 rounded-lg border border-white/20 focus:border-primary focus:outline-none" placeholder="@username">
                </div>
                <div>
                  <label class="block text-xs text-gray-400 mb-1">Portfolio</label>
                  <input type="url" id="edit-portfolio" value="${currentUser.socialLinks?.portfolio || ''}" class="w-full p-2 bg-white/10 rounded-lg border border-white/20 focus:border-primary focus:outline-none" placeholder="https://myportfolio.com">
                </div>
              </div>
            </div>
            
            <div class="flex gap-3">
              <button type="submit" class="flex-1 bg-primary text-black py-3 rounded-xl font-bold">üíæ Save Changes</button>
              <button type="button" onclick="this.closest('.modal').remove()" class="flex-1 bg-gray-600 py-3 rounded-xl font-bold">Cancel</button>
            </div>
          </form>
        </div>
      `;
      document.body.appendChild(modal);
    }

    function previewProfilePicture(input) {
      if (input.files && input.files[0]) {
        const reader = new FileReader();
        reader.onload = function(e) {
          const preview = document.getElementById('preview-avatar');
          preview.innerHTML = `<img src="${e.target.result}" class="w-full h-full object-cover rounded-full">`;
          currentUser.profilePicture = e.target.result;
        };
        reader.readAsDataURL(input.files[0]);
      }
    }

    function addSkillField() {
      const container = document.getElementById('skills-container');
      const skillDiv = document.createElement('div');
      skillDiv.className = 'flex items-center gap-2 mb-2';
      skillDiv.innerHTML = `
        <input type="text" placeholder="Skill name" class="flex-1 p-2 bg-white/10 rounded-lg border border-white/20 focus:border-primary focus:outline-none skill-input">
        <select class="p-2 bg-white/10 rounded-lg border border-white/20 skill-level">
          <option value="Beginner">Beginner</option>
          <option value="Intermediate" selected>Intermediate</option>
          <option value="Expert">Expert</option>
        </select>
        <button type="button" onclick="this.parentElement.remove()" class="bg-red-500/20 text-red-400 px-2 py-1 rounded">√ó</button>
      `;
      container.appendChild(skillDiv);
    }

    function saveProfileChanges(event) {
      event.preventDefault();
      
      const oldStrength = currentUser.profileStrength || 0;
      
      // Collect all form data
      currentUser.name = `${document.getElementById('edit-firstname').value} ${document.getElementById('edit-lastname').value}`;
      currentUser.headline = document.getElementById('edit-headline').value;
      currentUser.university = document.getElementById('edit-university').value;
      currentUser.department = document.getElementById('edit-department').value;
      currentUser.yearOfStudy = document.getElementById('edit-year').value;
      currentUser.gpa = parseFloat(document.getElementById('edit-gpa').value) || null;
      currentUser.phone = document.getElementById('edit-phone').value;
      currentUser.location = document.getElementById('edit-location').value;
      currentUser.bio = document.getElementById('edit-bio').value;
      
      // Collect skills with levels
      const skillInputs = document.querySelectorAll('.skill-input');
      const skillLevels = document.querySelectorAll('.skill-level');
      currentUser.skills = [];
      skillInputs.forEach((input, index) => {
        if (input.value.trim()) {
          currentUser.skills.push({
            name: input.value.trim(),
            level: skillLevels[index].value
          });
        }
      });
      
      // Collect social links
      currentUser.socialLinks = {
        github: document.getElementById('edit-github').value,
        linkedin: document.getElementById('edit-linkedin').value,
        telegram: document.getElementById('edit-telegram').value,
        portfolio: document.getElementById('edit-portfolio').value
      };
      
      // Calculate advanced profile strength
      let strength = 10; // Base
      if (currentUser.headline) strength += 15;
      if (currentUser.department) strength += 10;
      if (currentUser.yearOfStudy) strength += 5;
      if (currentUser.gpa) strength += 10;
      if (currentUser.phone) strength += 5;
      if (currentUser.location) strength += 5;
      if (currentUser.bio && currentUser.bio.length > 50) strength += 15;
      if (currentUser.skills && currentUser.skills.length > 0) strength += 10;
      if (currentUser.skills && currentUser.skills.length >= 3) strength += 10;
      if (currentUser.profilePicture) strength += 10;
      if (Object.values(currentUser.socialLinks).some(link => link)) strength += 10;
      
      currentUser.profileStrength = Math.min(strength, 100);
      
      // Award XP for profile improvements
      if (strength > oldStrength) {
        const xpGain = (strength - oldStrength) * 3;
        currentUser.xp = (currentUser.xp || 0) + xpGain;
        showNotification(`+${xpGain} XP for improving your profile!`, 'success');
      }
      
      saveUserData();
      updateUserUI();
      event.target.closest('.modal').remove();
      showNotification('‚úÖ Profile updated successfully!', 'success');
    }

    // Ekub Functions
    function showCreateEkubModal() {
      const modal = document.createElement('div');
      modal.className = 'modal active fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50';
      modal.innerHTML = `
        <div class="glass rounded-2xl p-6 max-w-md w-full mx-4">
          <h3 class="text-xl font-bold mb-6">ü§ù Create New Ekub</h3>
          <form onsubmit="createEkub(event)">
            <div class="mb-4">
              <label class="block text-sm font-medium mb-2">Ekub Name</label>
              <input type="text" id="ekub-name" class="w-full p-3 bg-white/10 rounded-xl border border-white/20 focus:border-primary focus:outline-none" placeholder="e.g., Laptop Fund" required>
            </div>
            <div class="mb-4">
              <label class="block text-sm font-medium mb-2">Monthly Contribution (ETB)</label>
              <input type="number" id="ekub-amount" class="w-full p-3 bg-white/10 rounded-xl border border-white/20 focus:border-primary focus:outline-none" placeholder="1000" min="100" required>
            </div>
            <div class="mb-4">
              <label class="block text-sm font-medium mb-2">Maximum Members</label>
              <input type="number" id="ekub-members" class="w-full p-3 bg-white/10 rounded-xl border border-white/20 focus:border-primary focus:outline-none" placeholder="12" min="3" max="20" required>
            </div>
            <div class="mb-6">
              <label class="block text-sm font-medium mb-2">Description</label>
              <textarea id="ekub-description" class="w-full p-3 bg-white/10 rounded-xl border border-white/20 focus:border-primary focus:outline-none" rows="3" placeholder="What is this ekub for?"></textarea>
            </div>
            <div class="flex gap-3">
              <button type="submit" class="flex-1 bg-primary text-black py-3 rounded-xl font-bold">Create Ekub</button>
              <button type="button" onclick="this.closest('.modal').remove()" class="flex-1 bg-gray-600 py-3 rounded-xl font-bold">Cancel</button>
            </div>
          </form>
        </div>
      `;
      document.body.appendChild(modal);
    }

    function createEkub(event) {
      event.preventDefault();
      
      const name = document.getElementById('ekub-name').value;
      const amount = parseInt(document.getElementById('ekub-amount').value);
      const maxMembers = parseInt(document.getElementById('ekub-members').value);
      const description = document.getElementById('ekub-description').value;
      
      const newEkub = {
        id: 'e' + Date.now(),
        name: name,
        contributionAmount: amount,
        totalAmount: amount * maxMembers,
        maxMembers: maxMembers,
        currentMembers: 1,
        description: description,
        creator: currentUser.name,
        status: 'Active',
        nextPayout: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000).toLocaleDateString()
      };
      
      if (!ekubs) ekubs = [];
      ekubs.push(newEkub);
      
      if (!currentUser.createdEkubs) currentUser.createdEkubs = [];
      currentUser.createdEkubs.push(newEkub.id);
      
      currentUser.xp = (currentUser.xp || 0) + 50;
      saveUserData();
      updateUserUI();
      
      event.target.closest('.modal').remove();
      showNotification(`ü§ù Ekub "${name}" created successfully!`, 'success');
    }

    // Network Functions
    function showNetworkModal() {
      const modal = document.createElement('div');
      modal.className = 'modal active fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50';
      modal.innerHTML = `
        <div class="glass rounded-2xl p-6 max-w-md w-full mx-4 max-h-[90vh] overflow-y-auto">
          <h3 class="text-xl font-bold mb-6">üë• Network & Connect</h3>
          <div class="space-y-4">
            <div class="bg-white/5 rounded-xl p-4">
              <div class="flex items-center gap-3 mb-3">
                <div class="w-12 h-12 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center font-bold">ST</div>
                <div>
                  <h4 class="font-bold">Sara Tadesse</h4>
                  <p class="text-sm text-gray-400">UI/UX Designer @ AAU</p>
                </div>
              </div>
              <div class="flex gap-2">
                <button onclick="connectWithUser('sara')" class="flex-1 bg-primary text-black py-2 rounded-lg font-semibold">Connect</button>
                <button onclick="messageUser('sara')" class="flex-1 bg-white/10 py-2 rounded-lg font-semibold">Message</button>
              </div>
            </div>
            
            <div class="bg-white/5 rounded-xl p-4">
              <div class="flex items-center gap-3 mb-3">
                <div class="w-12 h-12 bg-gradient-to-r from-green-500 to-teal-500 rounded-full flex items-center justify-center font-bold">MB</div>
                <div>
                  <h4 class="font-bold">Michael Belay</h4>
                  <p class="text-sm text-gray-400">Backend Developer @ JU</p>
                </div>
              </div>
              <div class="flex gap-2">
                <button onclick="connectWithUser('michael')" class="flex-1 bg-primary text-black py-2 rounded-lg font-semibold">Connect</button>
                <button onclick="messageUser('michael')" class="flex-1 bg-white/10 py-2 rounded-lg font-semibold">Message</button>
              </div>
            </div>
          </div>
          <button onclick="this.closest('.modal').remove()" class="w-full mt-6 bg-gray-600 py-3 rounded-xl font-bold">Close</button>
        </div>
      `;
      document.body.appendChild(modal);
    }

    function joinEkub(ekubId) {
      if (!currentUser) {
        showNotification('üîí Please sign in to join ekub', 'warning');
        showModal('login');
        return;
      }
      
      const ekubDetails = {
        'laptop-fund': { name: 'Laptop Fund Ekub', amount: 2000, members: 12 },
        'business-startup': { name: 'Business Startup', amount: 5000, members: 8 }
      };
      
      const ekub = ekubDetails[ekubId];
      if (!ekub) return;
      
      const modal = document.createElement('div');
      modal.className = 'modal active fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50';
      modal.innerHTML = `
        <div class="glass rounded-2xl p-6 max-w-md w-full mx-4">
          <h3 class="text-xl font-bold mb-4">ü§ù Join ${ekub.name}</h3>
          <div class="bg-white/5 rounded-lg p-4 mb-4">
            <div class="flex justify-between items-center mb-2">
              <span>Monthly Contribution:</span>
              <span class="font-bold text-accent">${ekub.amount} ETB</span>
            </div>
            <div class="flex justify-between items-center mb-2">
              <span>Current Members:</span>
              <span class="font-bold">${ekub.members}/12</span>
            </div>
            <div class="flex justify-between items-center">
              <span>Your Balance:</span>
              <span class="font-bold ${currentUser.walletBalance >= ekub.amount ? 'text-success' : 'text-red-400'}">${currentUser.walletBalance} ETB</span>
            </div>
          </div>
          
          <div class="mb-4">
            <label class="flex items-center gap-2">
              <input type="checkbox" id="ekub-terms" class="rounded">
              <span class="text-sm">I understand the ekub terms and commit to monthly payments</span>
            </label>
          </div>
          
          <div class="bg-yellow-500/20 border border-yellow-500/30 rounded-lg p-3 mb-4">
            <p class="text-sm text-yellow-200">‚ö†Ô∏è First payment of ${ekub.amount} ETB will be deducted immediately</p>
          </div>
          
          <div class="flex gap-3">
            <button onclick="confirmJoinEkub('${ekubId}', ${ekub.amount})" class="flex-1 bg-primary text-black py-3 rounded-xl font-bold">Join Ekub</button>
            <button onclick="this.closest('.modal').remove()" class="flex-1 bg-gray-600 py-3 rounded-xl font-bold">Cancel</button>
          </div>
        </div>
      `;
      document.body.appendChild(modal);
    }

    function confirmJoinEkub(ekubId, amount) {
      const termsChecked = document.getElementById('ekub-terms').checked;
      if (!termsChecked) {
        showNotification('‚ùå Please accept the ekub terms', 'error');
        return;
      }
      
      if (currentUser.walletBalance < amount) {
        showNotification('üí∞ Insufficient balance. Please add funds first.', 'error');
        return;
      }
      
      currentUser.walletBalance -= amount;
      
      if (!currentUser.joinedEkubs) currentUser.joinedEkubs = [];
      currentUser.joinedEkubs.push({
        id: ekubId,
        joinedAt: new Date().toLocaleDateString(),
        monthlyAmount: amount,
        status: 'Active'
      });
      
      transactions.unshift({
        id: 't' + Date.now(),
        type: 'Debit',
        amount: amount,
        description: `Ekub Payment - ${ekubId}`,
        date: new Date().toLocaleDateString(),
        status: 'Completed'
      });
      
      currentUser.xp = (currentUser.xp || 0) + 30;
      saveUserData();
      updateUserUI();
      
      document.querySelector('.modal.active').remove();
      showNotification('ü§ù Successfully joined ekub!', 'success');
    }
      if (!currentUser.connections) currentUser.connections = [];
      currentUser.connections.push(userId);
      currentUser.xp = (currentUser.xp || 0) + 5;
      saveUserData();
      updateUserUI();
      showNotification('ü§ù Connection request sent!', 'success');
    }

    function messageUser(userId) {
      showNotification('üí¨ Opening chat...', 'info');
      setTimeout(() => {
        showNotification('üì± Chat feature coming soon!', 'info');
      }, 1000);
    }

    function showNotification(message, type) {
      const colors = {
        success: 'bg-green-500',
        error: 'bg-red-500',
        warning: 'bg-yellow-500',
        info: 'bg-blue-500'
      };
      
      const notification = document.createElement('div');
      notification.className = `fixed top-4 right-4 ${colors[type]} text-white px-6 py-3 rounded-lg z-50`;
      notification.textContent = message;
      document.body.appendChild(notification);
      
      setTimeout(() => notification.remove(), 3000);
    }

    function refreshJobs() {
      showNotification('üîÑ Refreshing jobs...', 'info');
      loadJobs();
    }

    function refreshWallet() {
      showNotification('üîÑ Refreshing wallet...', 'info');
      updateUserUI();
    }

    function updateUI() {
      updateUserUI();
    }

    // Initialize app when page loads
    document.addEventListener('DOMContentLoaded', initApp);
  </script>
</body>
</html>